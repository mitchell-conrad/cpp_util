
# Testing library
FetchContent_Declare(
doctest
GIT_REPOSITORY https://github.com/onqtam/doctest.git
GIT_TAG        2.3.5
)
FetchContent_MakeAvailable(doctest)

set(DOCTEST_INCLUDE_DIR ${doctest_SOURCE_DIR}/doctest CACHE INTERNAL "Path to include folder for doctest")
include_directories(${DOCTEST_INCLUDE_DIR})

set(CPP_UTIL_INCLUDE_DIR ../include)
include_directories(${CPP_UTIL_INCLUDE_DIR})

# Disable warning generated by [[nodiscard]] in tests as doctest seems to discard results of function calls inside of
#  assert macros
add_compile_options(-Wno-unused-result)

add_executable(test_string test_string.cpp)
target_compile_features(test_string PRIVATE cxx_std_17)
target_link_libraries(test_string PRIVATE cpp_util)
add_test(NAME test_string COMMAND test_string)

add_executable(test_predicate test_predicate.cpp)
target_compile_features(test_predicate PRIVATE cxx_std_17)
add_test(NAME test_predicate COMMAND test_predicate)

add_executable(test_validation test_validation.cpp)
target_compile_features(test_validation PRIVATE cxx_std_17)
add_test(NAME test_validation COMMAND test_validation)

add_executable(test_algorithm test_algorithm.cpp)
target_compile_features(test_algorithm PRIVATE cxx_std_17)
add_test(NAME test_algorithm COMMAND test_algorithm)

add_executable(test_registry test_registry.cpp)
target_compile_features(test_registry PRIVATE cxx_std_17)
add_test(NAME test_registry COMMAND test_registry)

add_executable(test_mutex test_mutex.cpp)
target_compile_features(test_mutex PRIVATE cxx_std_17)
add_test(NAME test_mutex COMMAND test_mutex)

add_executable(test_ipv4 test_ipv4.cpp)
target_compile_features(test_ipv4 PRIVATE cxx_std_17)
add_test(NAME test_ipv4 COMMAND test_ipv4)

add_executable(test_socket_addr test_socket_addr.cpp)
target_compile_features(test_socket_addr PRIVATE cxx_std_17)
add_test(NAME test_socket_addr COMMAND test_socket_addr)
